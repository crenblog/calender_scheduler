import 'package:flutter/material.dart';
import 'package:calender_scheduler/config/app_routes.dart';
import 'package:intl/date_symbol_data_local.dart';
import 'package:calender_scheduler/Database/schedule_database.dart';
import 'package:get_it/get_it.dart';

// ===================================================================
// â­ï¸ Main Entry Point: ì•±ì˜ ì§„ì…ì 
// ===================================================================
// ì´ê±°ë¥¼ ì„¤ì •í•˜ê³  â†’ ì•± ì‹œì‘ ì „ í•„ìš”í•œ ì´ˆê¸°í™” ì‘ì—…ì„ ìˆ˜í–‰í•˜ê³ 
// ì´ê±°ë¥¼ í•´ì„œ â†’ ë°ì´í„°ë² ì´ìŠ¤, ë‚ ì§œ í¬ë§·, ì˜ì¡´ì„± ì£¼ì…ì„ ì¤€ë¹„í•œë‹¤
// ì´ê±°ëŠ” ì´ë˜ì„œ â†’ ì•±ì´ ì•ˆì •ì ìœ¼ë¡œ ì‹¤í–‰ë˜ê³  ëª¨ë“  ê¸°ëŠ¥ì´ ì •ìƒ ì‘ë™í•œë‹¤
// ì´ê±°ë¼ë©´ â†’ ì¤‘ì•™í™”ëœ ë¼ìš°íŠ¸ ì‹œìŠ¤í…œìœ¼ë¡œ í™”ë©´ ì „í™˜ì„ ê´€ë¦¬í•œë‹¤

void main() async {
  // ===================================================================
  // 1. Flutter í”„ë ˆì„ì›Œí¬ ì´ˆê¸°í™”
  // ===================================================================
  WidgetsFlutterBinding.ensureInitialized();
  // ì´ê±°ë¥¼ ì„¤ì •í•˜ê³  â†’ Flutter í”„ë ˆì„ì›Œí¬ê°€ ì¤€ë¹„ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì„œ
  // ì´ê±°ë¥¼ í•´ì„œ â†’ async ì‘ì—…ì´ main í•¨ìˆ˜ì—ì„œ ì•ˆì „í•˜ê²Œ ì‹¤í–‰ëœë‹¤
  print('ğŸš€ [main.dart] Flutter í”„ë ˆì„ì›Œí¬ ì´ˆê¸°í™” ì™„ë£Œ');

  // ===================================================================
  // 2. ë‚ ì§œ í¬ë§· ì´ˆê¸°í™” (ë‹¤êµ­ì–´ ì§€ì›)
  // ===================================================================
  await initializeDateFormatting();
  // ì´ê±°ë¥¼ ì„¤ì •í•˜ê³  â†’ í•œêµ­ì–´ ë‚ ì§œ í¬ë§·ì„ ë¡œë“œí•´ì„œ
  // ì´ê±°ë¥¼ í•´ì„œ â†’ "10ì›”", "ì›”ìš”ì¼" ê°™ì€ í•œêµ­ì–´ í‘œì‹œê°€ ê°€ëŠ¥í•˜ë‹¤
  print('ğŸ“… [main.dart] ë‚ ì§œ í¬ë§· ì´ˆê¸°í™” ì™„ë£Œ (í•œêµ­ì–´)');

  // ===================================================================
  // 3. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” ë° ì˜ì¡´ì„± ì£¼ì…
  // ===================================================================
  final database = AppDatabase();
  GetIt.instance.registerSingleton<AppDatabase>(database);
  // ì´ê±°ë¥¼ ì„¤ì •í•˜ê³  â†’ AppDatabase ì¸ìŠ¤í„´ìŠ¤ë¥¼ GetItì— ë“±ë¡í•´ì„œ
  // ì´ê±°ë¥¼ í•´ì„œ â†’ ì–´ë””ì„œë“  GetIt.I<AppDatabase>()ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë‹¤
  // ì´ê±°ëŠ” ì´ë˜ì„œ â†’ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì „ì—­ìœ¼ë¡œ ê³µìœ í•˜ê³  ì¤‘ë³µ ìƒì„±ì„ ë°©ì§€í•œë‹¤
  print('ğŸ—„ï¸ [main.dart] ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” ë° GetIt ë“±ë¡ ì™„ë£Œ');

  // ===================================================================
  // 4. ì´ˆê¸° ë°ì´í„° ë¡œë“œ (ì•± ì‹œì‘ ì‹œ ì˜¤ëŠ˜ ì¼ì • í™•ì¸)
  // ===================================================================
  final resp = await database.getSchedulesByDate(DateTime.now());
  print('ğŸ“Š [main.dart] ì˜¤ëŠ˜ ì¼ì • ì¡°íšŒ ì™„ë£Œ: ${resp.length}ê°œ');

  // ===================================================================
  // 5. ì•± ì‹¤í–‰
  // ===================================================================
  runApp(const CalendarSchedulerApp());
}

// ===================================================================
// â­ï¸ Calendar Scheduler App: ì•±ì˜ ë£¨íŠ¸ ìœ„ì ¯
// ===================================================================
// ì´ê±°ë¥¼ ì„¤ì •í•˜ê³  â†’ MaterialAppì— ì¤‘ì•™í™”ëœ ë¼ìš°íŠ¸ ì‹œìŠ¤í…œì„ ì ìš©í•´ì„œ
// ì´ê±°ë¥¼ í•´ì„œ â†’ ëª¨ë“  í™”ë©´ ì „í™˜ì„ ì¼ê´€ë˜ê²Œ ê´€ë¦¬í•œë‹¤
// ì´ê±°ëŠ” ì´ë˜ì„œ â†’ ì½”ë“œ ìœ ì§€ë³´ìˆ˜ê°€ ì‰½ê³  ë¼ìš°íŠ¸ ì¶”ê°€/ë³€ê²½ì´ ê°„ë‹¨í•˜ë‹¤

class CalendarSchedulerApp extends StatelessWidget {
  const CalendarSchedulerApp({Key? key}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      // ===================================================================
      // ì•± ê¸°ë³¸ ì„¤ì •
      // ===================================================================
      title: 'Calendar Scheduler',
      theme: ThemeData(
        fontFamily: 'Gmarket Sans',
        // ì¶”ê°€ í…Œë§ˆ ì„¤ì • ê°€ëŠ¥
      ),

      // ===================================================================
      // â­ï¸ ë¼ìš°íŠ¸ ì¤‘ì•™í™”: ëª¨ë“  í™”ë©´ ì „í™˜ì„ í•œ ê³³ì—ì„œ ê´€ë¦¬
      // ===================================================================
      initialRoute: AppRoutes.home,
      onGenerateRoute: AppRoutes.onGenerateRoute,
      // ì´ê±°ë¥¼ ì„¤ì •í•˜ê³  â†’ AppRoutesì˜ onGenerateRouteë¥¼ ì‚¬ìš©í•´ì„œ
      // ì´ê±°ë¥¼ í•´ì„œ â†’ ë¼ìš°íŠ¸ ì´ë¦„ìœ¼ë¡œ í™”ë©´ì„ ìƒì„±í•˜ê³  ì• ë‹ˆë©”ì´ì…˜ì„ ì ìš©í•œë‹¤
      // ì´ê±°ëŠ” ì´ë˜ì„œ â†’ Navigator.pushNamed()ë§Œìœ¼ë¡œ ëª¨ë“  í™”ë©´ ì „í™˜ì´ ê°€ëŠ¥í•˜ë‹¤
      // ì´ê±°ë¼ë©´ â†’ ë¼ìš°íŠ¸ ê²½ë¡œë¥¼ ìˆ˜ì •í•  ë•Œ app_routes.dartë§Œ ë³€ê²½í•˜ë©´ ëœë‹¤

      // ===================================================================
      // ë””ë²„ê·¸ ë°°ë„ˆ ì œê±° (ë¦´ë¦¬ì¦ˆ ë¹Œë“œ ì‹œ)
      // ===================================================================
      debugShowCheckedModeBanner: false,
    );
  }
}
